<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—©è¯»ä»»åŠ¡æ¿</title>
    <style>
        /* å…¨å±€è®¾ç½® */
        html, body { 
            margin: 0; 
            padding: 0; 
            height: 100%; 
            font-family: 'Segoe UI', Tahoma, Arial, sans-serif; 
            background-color: #f0f2f5;
            /* å¼€å¯ç£å¸æ»šåŠ¨æ•ˆæœ */
            scroll-snap-type: y mandatory;
            scroll-behavior: smooth;
        }

        /* æ¯ä¸€å±çš„æ ·å¼ */
        .section {
            height: 100vh; /* å¼ºåˆ¶é«˜åº¦ä¸ºå±å¹•çš„ 100% */
            width: 100%;
            box-sizing: border-box;
            padding: 40px 60px;
            scroll-snap-align: start; /* æ»šåŠ¨æ—¶è‡ªåŠ¨å¯¹é½é¡¶éƒ¨ */
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* ç¬¬ä¸€å±ï¼šæ—©è¯» (æµ…è“èƒŒæ™¯) */
        .section-reading {
            background-color: #fff;
            border-bottom: 5px solid #007bff;
        }

        /* ç¬¬äºŒå±ï¼šé»˜å†™ (æµ…çº¢èƒŒæ™¯) */
        .section-dictation {
            background-color: #fff;
            border-top: 5px solid #dc3545;
        }

        /* æ ‡é¢˜æ ·å¼ */
        h2 {
            font-size: 2.5em; /* æ ‡é¢˜æ›´å¤§ */
            margin: 0 0 30px 0;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .section-reading h2 { color: #007bff; border-color: #007bff; }
        .section-dictation h2 { color: #dc3545; border-color: #dc3545; }

        /* å†…å®¹åŒºåŸŸæ ·å¼ */
        .content {
            font-size: 2em; /* æ­£æ–‡å­—å·æå¤§ï¼Œæ–¹ä¾¿åæ’çœ‹æ¸… */
            line-height: 1.6;
            color: #333;
            white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œç¬¦ */
            flex: 1; /* å æ»¡å‰©ä½™ç©ºé—´ */
            overflow-y: auto; /* å¦‚æœå†…å®¹å®åœ¨å¤ªå¤šï¼Œå…è®¸å†…éƒ¨æ»šåŠ¨ */
        }

        /* é”å®šçŠ¶æ€æ ·å¼ */
        .locked-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            background: #fafafa;
            border: 4px dashed #ddd;
            border-radius: 20px;
            color: #888;
        }
        .timer { font-size: 5em; font-weight: bold; color: #dc3545; margin: 20px 0; font-variant-numeric: tabular-nums; }
        
        .server-time-tag { font-size: 0.4em; background: #eee; padding: 5px 15px; border-radius: 20px; vertical-align: middle; color: #666; font-weight: normal; margin-left: 20px; }
        .hidden { display: none !important; }

        /* å‘ä¸‹ç®­å¤´çš„æç¤ºåŠ¨ç”» */
        .arrow-down {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2em;
            color: #ccc;
            animation: bounce 2s infinite;
            cursor: pointer;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateX(-50%) translateY(0);}
            40% {transform: translateX(-50%) translateY(-10px);}
            60% {transform: translateX(-50%) translateY(-5px);}
        }
    </style>
</head>
<body>

    <!-- ç¬¬ä¸€å±ï¼šæ—©è¯»ä»»åŠ¡ -->
    <div class="section section-reading">
        <h2>ğŸ“– æ—©è¯»ä»»åŠ¡</h2>
        <div id="reading" class="content">
            æ­£åœ¨è¿æ¥æœåŠ¡å™¨è·å–ä»»åŠ¡...
        </div>
        <!-- æç¤ºå¾€ä¸‹æ»šåŠ¨çš„ç®­å¤´ -->
        <div class="arrow-down" onclick="window.scrollTo(0, window.innerHeight)">â¬‡ï¸ é»˜å†™åœ¨ä¸‹é¢</div>
    </div>

    <!-- ç¬¬äºŒå±ï¼šé»˜å†™ä»»åŠ¡ -->
    <div class="section section-dictation">
        <h2>
            âœï¸ é»˜å†™ä»»åŠ¡ 
            <span class="server-time-tag">ğŸ•’ ç½‘ç»œæ—¶é—´è‡ªåŠ¨ç®¡æ§</span>
        </h2>

        <!-- é»˜å†™å†…å®¹ -->
        <div id="dictation" class="content hidden"></div>

        <!-- é”å®šæç¤º -->
        <div id="lock" class="locked-area">
            <span style="font-size: 2em;">ğŸ”’ ä»»åŠ¡é”å®šä¸­</span>
            <div id="status-text" class="timer">--:--</div>
            <div style="font-size: 1.2em">å°†åœ¨ <span id="target-time" style="font-weight:bold; color:#333">--:--</span> è‡ªåŠ¨å¼€å¯</div>
            <div style="font-size: 1em; color: #aaa; margin-top: 10px;">(ä¿®æ”¹æœ¬æœºæ—¶é—´æ— æ•ˆ)</div>
        </div>
    </div>

    <script>
        // ä¿æŒä¹‹å‰çš„é˜²ä½œå¼Šé€»è¾‘å®Œå…¨ä¸å˜
        function loadTask() {
            fetch('data.json?t=' + new Date().getTime())
                .then(response => {
                    const serverDateStr = response.headers.get('Date');
                    if (!serverDateStr) throw new Error("æ— æ³•è·å–æœåŠ¡å™¨æ—¶é—´");
                    const serverTime = new Date(serverDateStr);
                    return response.json().then(data => ({ data, serverTime }));
                })
                .then(({ data, serverTime }) => {
                    document.getElementById('reading').innerText = data.reading;
                    document.getElementById('target-time').innerText = data.open_time;
                    checkTime(data, serverTime);
                })
                .catch(err => console.error("åŠ è½½ä¸­...", err));
        }

        function checkTime(data, serverTime) {
            let beijingHours = serverTime.getUTCHours() + 8;
            if (beijingHours >= 24) beijingHours -= 24;
            
            const hh = beijingHours.toString().padStart(2, '0');
            const mm = serverTime.getUTCMinutes().toString().padStart(2, '0');
            const currentServerHM = `${hh}:${mm}`;

            const dictationDiv = document.getElementById('dictation');
            const lockDiv = document.getElementById('lock');
            const statusText = document.getElementById('status-text');

            if (currentServerHM >= data.open_time) {
                dictationDiv.innerText = data.dictation;
                dictationDiv.classList.remove('hidden');
                lockDiv.classList.add('hidden');
            } else {
                dictationDiv.classList.add('hidden');
                lockDiv.classList.remove('hidden');
                statusText.innerText = `å½“å‰ ${currentServerHM}`;
            }
        }

        loadTask();
        setInterval(loadTask, 5000);
    </script>
</body>
</html>
